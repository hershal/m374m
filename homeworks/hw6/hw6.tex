\documentclass[12pt]{article}
\title{M374M Homework 6 \\
  \normalsize{\S~2.6.3 \#5$^1$, \S~2.6.4 \#2ab$^2$}}
\author{Hershal Bhave (hb6279)}
\date{Due 2016--03--09}

\usepackage{homework-macros}
\usepackage{changepage,ifthen}
\newcommand\skiptooddpage{
   \checkoddpage
   \ifthenelse{\boolean{oddpage}}
      {\null\clearpage\null\clearpage}
      {\null\clearpage}
}
\tikzexternalize

\begin{document}
\maketitle
\section{\S~2.6.3}
\subsection{5$^1$}
\subsubsection*{Problem}
Beginning with the SIR model, assume that recovered individuals can lose their
immunity and become susceptible again after an average recovery period of time
$\mu$. That is, the rate recovered individuals become susceptible is $\mu R$.
Draw a compartmental diagram and formulate a two-dimensional system of model
equations for S and I. Then:
\begin{enumerate}[(a)]
\item Find the two equilibria
\item Sketch the nullclines and the vector field
\item Identify the type of equilibria
\item Show that the disease-free equilibrium is unstable
\item Determine the stabilty of the nonzero equilibrium
\end{enumerate}

\subsection*{Remarks}
Use the condition $\text{S} + \text{I} + \text{R} = \text{N}$ to get a
two-variable system for S, I. For concreteness, assume $N>b/a$ and $\mu=b/2$;
characterize the stability of equilibria in terms of the parameter $aN/b>1$.

\subsection*{Solution}
\todo{}

\newpage
\section{\S~2.6.4}
\subsection{2a$^2$}
\subsubsection*{Problem}
\begin{equation}
  \label{eq:2.6.4.2-problem}
  \begin{aligned}
    \od{h}{t} &= ab\left( \frac{M_T}{H_T} \right)m(1-h)-rh, \\
    \od{m}{t} &= ach(1-m)-\mu m. \\
  \end{aligned}
\end{equation}
Nondimensionalize the system in \cref{eq:2.6.4.2-problem} by rescaling time
using $\tau = \mu t$. Be sure to obtain
\begin{equation*}
  \begin{aligned}
    \od{h}{\tau} = \lambda m(1-h) - \epsilon h, \\
    \od{m}{\tau} = \eta h(1-m) - m,
  \end{aligned}
\end{equation*}
where
\begin{equation*}
  \epsilon=\frac{r}{\mu},\quad \lambda=\frac{ab}{\mu}\frac{M_T}{H_T},\quad\eta=\frac{ac}{\mu}.
\end{equation*}

\subsubsection*{Remarks}
Characterize the stability of equilibria in terms of the parameter $\lambda>0$
and $\eta>0$.

\subsection*{Solution}
We may non-dimensionalize \cref{eq:2.6.4.2-problem} by multiplying by
$\od{t}{\tau}$.
\begin{equation*}
  \begin{aligned}
    \frac{\dd{h}}{\cancel{\dd{t}}}\frac{\cancel{\dd{t}}}{\dd{\tau}} &=
    \od{t}{\tau}\left[ab\left(\frac{M_T}{H_T}\right)m(1-h)-rh \right] \\
    \od{h}{\tau} &= \frac{ab}{\mu}\left(\frac{M_T}{H_T}\right)m(1-h) -
    \frac{r}{\mu}h \\
    \implies \od{h}{\tau} &= \lambda m(1-h) - \eta h \\
  \end{aligned}
\end{equation*}
and
\begin{equation*}
  \begin{aligned}
    \frac{\dd{m}}{\cancel{\dd{t}}}\frac{\cancel{\dd{t}}}{\dd{\tau}} &= ach(1-m)-\mu m \\
    \od{m}{\tau} &= \frac{ac}{\mu}h(1-m) - m \\
    \implies \od{m}{\tau} &= \eta h(1-m) - m \\
  \end{aligned}
\end{equation*}
where
\begin{equation*}
  \epsilon=\frac{r}{\mu},\quad \lambda=\frac{ab}{\mu}\frac{M_T}{H_T},\quad\eta=\frac{ac}{\mu}.
\end{equation*}
\newcommand{\otherequilibrium}{\left(\frac{\eta\lambda-\epsilon}{\eta(\lambda+\epsilon)},
  \frac{\eta\lambda-\epsilon}{\eta\lambda+\lambda}\right)}
Solving $\od{h}{\tau}=0$, $\od{m}{\tau}=0$ yields equilibria at $(0,0)$ and
$\otherequilibrium$. To determine the stability of these equilibria we'll find
the Jacobian and evaluate it at the equilibria.
\begin{equation*}
  J =
  \begin{pmatrix}
    -\epsilon-m\lambda & (1-h)\lambda \\
    (1-m)\eta  & -h\eta-1 \\
  \end{pmatrix}
\end{equation*}
About $(0,0)$,
\begin{equation*}
  J(0,0) =
  \begin{pmatrix}
    -\epsilon & \lambda \\
    \eta & -1 \\
  \end{pmatrix}
\end{equation*}
so that
\begin{equation*}
  \begin{aligned}
    \det{J} &= \epsilon-\lambda\eta \\
    \tr{J} &= -\epsilon-1. \\
  \end{aligned}
\end{equation*}
This indicates that $(0,0)$ is stable if $\epsilon>\lambda\eta$ and unstable if
$\epsilon<\lambda\eta$.

About $\otherequilibrium$, which we'll rename as
$(h_*,m_*)$,
\begin{equation*}
  J(h_*,m_*) =
  \begin{pmatrix}
    -\epsilon-m_*\lambda & (1-h_*)\lambda \\
    (1-m_*)\eta  & -h_*\eta-1 \\
  \end{pmatrix}
\end{equation*}
so that
\begin{equation*}
  \begin{aligned}
    \det{J} &= \lambda(\eta(h-1)+(\eta+1)m)+\eta h\epsilon+\epsilon \\
    \tr{J} &= -\eta h-\lambda m-\epsilon-1. \\
  \end{aligned}
\end{equation*}
This indicates that $(h_*,m_*)$ is guaranteed stable for any $\lambda$, $\eta$,
and $\epsilon$ as long as $h>1$.

\newpage
\subsection{2b$^2$}
\subsubsection*{Problem}
Assuming $\epsilon$ is very small, neglect the $\epsilon h$ term in the host equation
and draw the phase portrait. Include the equilibria, nullclines, direction
field, and local stability analysis for the equilibria.

\subsubsection*{Remarks}
Characterize the stability of equilibria in terms of the parameter $\lambda>0$
and $\eta>0$.

\subsection*{Solution}
Let
\begin{equation*}
  \begin{aligned}
    \od{h}{\tau} = \lambda m(1-h), \\
    \od{m}{\tau} = \eta h(1-m) - m. \\
  \end{aligned}
\end{equation*}
We'll first determine the equilibria.
\begin{equation*}
  \begin{aligned}
    0 &= \lambda m(1-h) \\
    m&=0,\quad h=1.
  \end{aligned}
\end{equation*}
When $m=0$,
\begin{equation*}
  \begin{aligned}
    0 &= \eta h(1-m)-m \\
    &= \eta h \\
    \implies h=0.
  \end{aligned}
\end{equation*}
When $h=1$,
\begin{equation*}
  \begin{aligned}
    0 &= \eta h(1-m)-m \\
    &= \eta(1-m)-m \\
    &= \eta - \eta m - m \\
    \eta &= m(1+\eta) \\
    \implies m &= \frac{\eta}{1+\eta}.
  \end{aligned}
\end{equation*}
The equilibria are $(0,0)$, $(1,\frac{\eta}{1+\eta})$. Now we'll determine the
stability of each by computing the Jacobian.
\begin{equation*}
  J =
  \begin{pmatrix}
    -m \lambda  & (1-h) \lambda  \\
    (1-m) \eta  & -h \eta -1 \\
  \end{pmatrix}
\end{equation*}
About $(0,0)$,
\begin{equation*}
  J(0,0) =
  \begin{pmatrix}
    0 & \lambda \\
    \eta & -1 \\
  \end{pmatrix}
\end{equation*}
so that
\begin{equation*}
  \begin{aligned}
    \det{J} &= -\lambda\eta \\
    \tr{J} &= -1.
  \end{aligned}
\end{equation*}
This indicates that $(0,0)$ is a saddle point.

About $(1,\frac{\eta}{1+\eta})$,
\begin{equation*}
  J\left(1,\frac{\eta}{1+\eta}\right) =
  \begin{pmatrix}
    -m \lambda  & (1-h) \lambda  \\
    (1-m) \eta  & -h \eta -1 \\
  \end{pmatrix}
\end{equation*}
so that
\begin{equation*}
  \begin{aligned}
    \det{J} &= \lambda\eta \\
    \tr{J} &= -1-\eta-\frac{\eta\lambda}{1+\eta}. \\
  \end{aligned}
\end{equation*}
This indicates that $(1,\frac{\eta}{1+\eta})$ is stable.

Reference \cref{fig:2.6.4.2b-phase-diagram}.
\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{axis}[height=13.25cm, width=13.25cm,
      domain=-1:2,
      restrict x to domain=-1:2, xmin=-1, xmax=2,
      restrict y to domain=-1:2, ymin=-1, ymax=2,
      xtick={0}, ytick={0},
      view={0}{90},
      xlabel=$h$,
      ylabel=$m$]
      \foreach \i in {1,...,6} {
        \addplot3[decoration={
          markings,
          mark=between positions 0.1 and 0.9 step 5em with {\arrow [scale=1.5]{stealth}}
        }, postaction=decorate] table {src-bin/2.6.4.2b-\i.mat};
      }
      \addplot3[gray, quiver={u={2*y*(1-x)}, v={3*x*(1-y)-y}, scale arrows=0.05}, -stealth,samples=15]{0};
      \addplot3[gray, dashed, very thin] coordinates {(-1,0,0) (2,0,0)};
      \addplot3[gray, dashed, very thin] coordinates {(0,-1,0) (0,2,0)};
      \addplot3[only marks] table {
        0 0 0
        1 0.666 0
      };
      \addplot3[gray,dashed,very thin,samples y=1] (x, {(x*2)/(1+x*2)}, 0);
    \end{axis}
  \end{tikzpicture}
  \caption{Phase Diagram for \S~2.6.4\#2b}
  \label{fig:2.6.4.2b-phase-diagram}
\end{figure}

\skiptooddpage{}
\section{Programming Minilab}
Consider a uniform, rectangular rigid body of mass $m$ and dimensions $a$, $b$ and $c$. In
the absence of an applied torque, the rotational motion of the body is described by
the system
\begin{equation}
  \label{eq:minilab-problem}
  \dot{u}=u\times(Ku),\quad u(0)=u_0
\end{equation}
where $u = (u_1, u_2, u_3)$ is the angular momentum vector as seen in the body
frame, $K = \text{diag}(\alpha, \beta, \gamma)$ is a diagonal matrix of inertia
parameters, and $\times$ is the vector cross product. Here we study the steady
states of the above system and their stability. We assume $u \ne 0$; without
loss of generality we suppose $\abs{u_0}=1$. The angular velocity or spin vector
is given by $\omega = Ku$ and the parameters are defined by
\begin{equation*}
  \alpha = \frac{12}{m(a^2+c^2)},\quad\beta = \frac{12}{m(a^2+b^2)},\quad \gamma = \frac{12}{m(b^2+c^2)},
\end{equation*}
Notice $c>b>a>0$ implies $\beta>\alpha>\gamma>0$.

\begin{enumerate}[(a)]
\item Show that \cref{eq:minilab-problem} takes the form
  \begin{equation*}
    \dot{u_1}=\eta_1u_2u_3,\quad\dot{u_2}=\eta_2u_3u_1,\quad\dot{u_3}=\eta_3u_1u_2
  \end{equation*}
  where
  \begin{equation*}
    \eta_1=\gamma-\beta,\quad\eta_2=\alpha-\gamma,\quad\eta_3=\beta-\alpha.
  \end{equation*}
  Deduce that the only possible steady states are $u_*=$ $(\pm1,0,0)$,
  $(0,\pm1,0)$, $(0,0,\pm1)$. Hence the only possible steady spin vectors
  $\omega_*$ are parallel to a coordinate axis.
\item Show that the functions
  \begin{equation*}
    E(u) = u_1^2+u_2^2+u_3^2,\quad F(u)=\alpha u_1^2+\beta u_2^2+\gamma u_3^2
  \end{equation*}
  are constant along every solution of \cref{eq:minilab-problem}. Since $E(u(t))
  = E(u_0) = 1$, conclude that every solution evolves on the unit sphere.
  Moreover, conclude that every solution satisfies $F(u(t)) = F(u_0)$, where
  $\gamma\le F(u_0)\le\beta$.
\item For any $u_0$ near the equilibrium $(0, 0, 1)$, we have $F (u_0) \ge
  \gamma$, say $F (u_0) = \gamma + \delta$ for some small $\delta\ge0$. Using
  the equations $E(u) = 1$ and $F(u) = \gamma + \delta$, show that solution
  curves near $(0, 0, 1)$ are ellipses on the sphere around this point. Hence
  $(0, 0, 1)$ is a neutrally stable center. (The same result holds for $(0, 0,
  −1)$ and also $(0, \pm1, 0)$)
\item For any $u_0$ near the equilibrium $(1, 0, 0)$, the value $F(u_0)$ is near
  $\alpha$, but may be larger or smaller, so $F(u_0) = \alpha\pm\delta$ for some
  small $\delta\ge0$. Using the equations $E(u) = 1$ and $F(u) =
  \alpha\pm\delta$, show that solution curves near $(1, 0, 0)$ are hyperbolas on
  the sphere around this point. Hence $(1, 0, 0)$ is an unstable saddle. (The
  same result holds for $(−1, 0, 0)$)
\item Simulate the model equation in \cref{eq:minilab-problem} and produce
  solution curves for various $u_0$. Using $m = 2\text{kg}$, $c = 0.24\text{m}$,
  $b = 0.16\text{m}$ and $a = 0.03\text{m}$, illustrate the behavior of the
  system for initial conditions near the different equilibria. Find a book with
  dimensions $c > b > a$ (the more different the better) and verify your results
  by direct experiment! Can you get the book to steadily spin about the axis
  parallel to edge $b$? What about $a$ or $c$?
\end{enumerate}
\newpage
\subsubsection*{Solution}
\begin{enumerate}[(a)]
\item In this system, we may compute $\dot{u}$ directly.
  \begin{equation*}
    K =
    \begin{pmatrix}
      \alpha & 0 & 0 \\
      0 & \beta & 0 \\
      0 & 0 & \gamma \\
    \end{pmatrix},
    \quad u = \begin{pmatrix} u_1 \\ u_2 \\ u_3 \\ \end{pmatrix}.
  \end{equation*}
  \begin{equation*}
    \begin{aligned}
      \dot{u} &= u \times (Ku) \\
      &= \begin{pmatrix} u_1 \\ u_2 \\ u_3 \end{pmatrix} \times
      \begin{pmatrix} \alpha u_1 \\ \beta u_2 \\ \gamma u_3 \end{pmatrix} \\
      &= \begin{vmatrix}
        \vec{\imath} & \vec{\jmath} & \vec{k} \\
        u_1 & u_2 & u_3 \\
        \alpha u_1 & \beta u_2 & \gamma u_3 \\
      \end{vmatrix} \\
      &=
      \begin{pmatrix}
        (\gamma-\beta)u_2u_3 \\
        (\alpha-\gamma)u_1u_3 \\
        (\beta-\alpha)u_1u_2 \\
      \end{pmatrix} \\
      \implies \dot{u} &=
      \begin{pmatrix}
        \eta_1u_2u_3 \\
        \eta_2u_1u_3 \\
        \eta_3u_1u_2 \\
      \end{pmatrix}
    \end{aligned}
  \end{equation*}
  ``Steady state'' implies $\dot{u}=0$, and the problem statement writes
  $\abs{u_0}=1$. Combined with the result obtained in the computation of
  $\dot{u}=u\times(Ku)$, the only possible steady states are when $u_*=$
  $(\pm1,0,0)$, $(0,\pm1,0)$, $(0,0,\pm1)$.
\item When a function is constant its derivative is zero.
  \begin{equation*}
    \begin{aligned}
      \od{E}{t} &= \pd{E}{u_1}\od{u_1}{t} + \pd{E}{u_2}\od{u_2}{t} + \pd{E}{u_3}\od{u_3}{t} \\
      &= 2u_1\dot{u_1} + 2u_2\dot{u_2} + 2u_3\dot{u_3} \\
      &= 2u_1u_2u_3 + 2u_1u_2u_3 + 2u_1u_2u_3 \\
      &= 6u_1u_2u_3 \\
    \end{aligned}
  \end{equation*}
  Since the steady state solutions are parallel to the coordinate axes,
  $\od{E}{t}=0$, and thus $E(u)$ is constant. \todo{Talk about $F(u)$}
\item \label{itm:minilab-c} Solving $E(u)=0$ for $u_3^2$ yields $u_3^2=1-u_1^2-u_2^2$, which we may
  insert into $F(u)$.
  \begin{equation*}
    \begin{aligned}
      F(u) &= \gamma + \delta \\
      \gamma + \delta &= \alpha u_1^2+\beta u_2^2+\gamma u_3^2 \\
      &= \alpha u_1^2+\beta u_2^2+\gamma (1-u_1^2-u_2^2) \\
      &= \alpha u_1^2+\beta u_2^2+\gamma - \gamma u_1^2 - \gamma u_2^2 \\
      \implies \gamma + \delta &= \gamma + u_1^2(\alpha-\gamma) + u_2^2(\beta-\gamma) \\
    \end{aligned}
  \end{equation*}
  Since $\beta>\alpha>\gamma>0$, the solution curves model ellipses near $(0,0,1)$.
\item Similar to \cref{itm:minilab-c}, we may solve $E(u)=0$ for $u_1$ and
  substitute $u_1$ in $F(u)$.
  \begin{equation*}
    \begin{aligned}
      F(u) &= \alpha \pm \delta \\
      \alpha \pm \delta &= \alpha u_1^2+\beta u_2^2+\gamma u_3^2 \\
      &= \alpha(1-u_2^2-u_3^2)+\beta u_2^2 + \gamma u_3^2 \\
      &= \alpha-\alpha u_2^2-\alpha u_3^2+\beta u_2^2 + \gamma u_3^2 \\
      \implies \alpha \pm \delta &= \alpha - u_2^2(\beta-\alpha) - u_3^2(\gamma-\alpha) \\
    \end{aligned}
  \end{equation*}
  Since $\beta>\alpha>\gamma>0$, the solution curves model hyperbolas near
  $(1,0,0)$.
\end{enumerate}
\todo{}

\end{document}